---
phase: 03-cicd-pipeline
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .github/workflows/test.yml
autonomous: true

must_haves:
  truths:
    - "Pushing a commit to main triggers a GitHub Actions run that executes all Jest tests"
    - "Opening a PR triggers a GitHub Actions run that executes all Jest tests"
    - "Test failures are reported clearly in the Actions UI"
  artifacts:
    - path: ".github/workflows/test.yml"
      provides: "Test CI workflow"
      contains: "npm test"
  key_links:
    - from: ".github/workflows/test.yml"
      to: "package.json scripts.test"
      via: "npm test command"
      pattern: "run: npm test"
---

<objective>
Create a GitHub Actions test workflow that runs Jest tests on every push to main and on PRs.

Purpose: Automated test gate ensures regressions are caught before merge.
Output: `.github/workflows/test.yml` with push/PR triggers running `npm test` on ubuntu.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@package.json
@jest.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create test workflow</name>
  <files>.github/workflows/test.yml</files>
  <action>
Create `.github/workflows/test.yml` with:

Triggers:
- `push: branches: [main]`
- `pull_request: branches: [main]`

Job `test`:
- `runs-on: ubuntu-latest`
- Steps:
  1. `actions/checkout@v4`
  2. `actions/setup-node@v4` with `node-version: '20'`
  3. `run: npm ci`
  4. `run: npm test`

Notes:
- Use `npm ci` (not `npm install`) for reproducible CI installs
- Do NOT include E2E tests (Playwright+Electron requires a display and macOS; Jest tests are the CI-appropriate suite)
- Do NOT add caching (premature optimization for this project size)
- Do NOT add matrix builds (single Node version is sufficient)
  </action>
  <verify>
Validate YAML syntax: `python3 -c "import yaml; yaml.safe_load(open('.github/workflows/test.yml'))"`
Verify the file contains: push trigger, pull_request trigger, npm test step.
  </verify>
  <done>
`.github/workflows/test.yml` exists with correct triggers and steps. Pushing to main or opening a PR will trigger the test job.
  </done>
</task>

</tasks>

<verification>
- File `.github/workflows/test.yml` exists and is valid YAML
- Workflow triggers on push to main and pull_request to main
- Job runs `npm ci` then `npm test` on ubuntu-latest with Node 20
- No E2E tests included (they require macOS + display)
</verification>

<success_criteria>
- `.github/workflows/test.yml` is syntactically valid
- Triggers cover both push to main and PRs targeting main
- Uses ubuntu-latest runner (cost-effective for Jest-only tests)
- Runs `npm test` which executes all Jest project suites
</success_criteria>

<output>
After completion, create `.planning/phases/3/03-01-SUMMARY.md`
</output>
